import os
import sys
import subprocess

# Define the target to scan
target = "example.com"

# Define the path to the report file
report_file = "exploits_report.txt"

# Define the searchsploit command
searchsploit_command = ["searchsploit", target]

# Run the searchsploit command to get the possible exploits
try:
    searchsploit_output = subprocess.check_output(searchsploit_command)
except subprocess.CalledProcessError as e:
    print(f"Error: {e}")
    sys.exit(1)

# Parse the searchsploit output to get the list of exploits
exploits = []
for line in searchsploit_output.decode("utf-8").splitlines():
    if line.startswith("Exploit:"):
        exploits.append(line.strip().split(": ")[1])

# Generate the report
with open(report_file, "w") as f:
    f.write(f"Possible Exploits Report for {target}\n\n")
    for exploit in exploits:
        f.write(f"- {exploit}\n")
